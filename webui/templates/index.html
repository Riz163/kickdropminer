<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{{ t.get('app_title', 'KickDropMiner') }} â€¢ Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <div class="wrap">
      <header class="topbar">
        <div class="brand">
          <div class="logo">KD</div>
          <div class="title">{{ t.get('app_title', 'KickDropMiner') }}</div>
        </div>

        <div class="controls">
          <div class="selects">
            <select id="game-select" aria-label="{{ t.get('select_game', 'Select game') }}">
              {% for g in games %}
              <option value="{{ g.id }}" {% if g.id == current_game_id %}selected{% endif %}>{{ g.name }}</option>
              {% endfor %}
            </select>

            <select id="mode-select" aria-label="{{ t.get('select_mode', 'Select mode') }}">
              {% for key, label in drop_types %}
              <option value="{{ key }}" {% if key == current_drop_type %}selected{% endif %}>{{ label }}</option>
              {% endfor %}
            </select>

            <button id="apply-btn" class="btn">{{ t.get('apply', 'Apply') }}</button>
          </div>

          <div class="buttons">
            <button id="farmer-toggle" class="btn primary">{{ t.get('stop', 'Stop') if farmer_status == 'RUNNING' else t.get('start', 'Start') }}</button>
            <button id="refresh" class="btn">{{ t.get('refresh', 'Refresh') }}</button>
            <button id="theme-toggle" class="btn icon">ðŸŒ“</button>
          </div>
        </div>
      </header>

      <main class="main">
        <section class="left">
          <div class="card status-card">
            <div class="card-row">
              <div class="card-title">{{ t.get('overall_progress', 'Overall Progress') }}</div>
              <div id="farmer-state" class="muted small">{{ farmer_status }}</div>
            </div>
            <div id="campaigns-list" class="campaigns-grid">
              <div class="muted small">{{ t.get('loading_campaigns', 'Loading campaignsâ€¦') }}</div>
            </div>
          </div>

          <div class="card streamers-card">
            <div class="card-title">{{ t.get('targeted_streamers', 'Targeted Streamers') }}</div>
            <div id="streamers-list" class="list">
              <div class="muted small">{{ t.get('loading_streamers', 'Loading streamersâ€¦') }}</div>
            </div>
          </div>
        </section>

        <aside class="right">
          <div class="card logs-card">
            <div class="card-title">{{ t.get('farmer_logs', 'Farmer Logs') }}</div>
            <div id="logs" class="logs">{{ t.get('loading_logs', 'Loading logsâ€¦') }}</div>
            <div class="logs-actions">
              <button id="clear-logs" class="btn">{{ t.get('clear', 'Clear') }}</button>
              <button id="download-logs" class="btn">{{ t.get('download', 'Download') }}</button>
            </div>
          </div>

          <div class="card control-card">
            <div class="card-title">{{ t.get('quick_info', 'Quick Info') }}</div>
            <div class="info-row"><span class="muted">{{ t.get('farmer', 'Farmer') }}</span><strong id="farmer-quick">{{ farmer_status }}</strong></div>
            <div class="info-row"><span class="muted">{{ t.get('selected_game', 'Selected Game') }}</span><strong id="selected-game">{{ games[0].name if games else 'â€”' }}</strong></div>
            <div class="info-row"><span class="muted">{{ t.get('mode', 'Mode') }}</span><strong id="selected-mode">{{ current_drop_type }}</strong></div>
          </div>
        </aside>
      </main>

      <footer class="footer">
        {{ t.get('made_with', 'Made with') }} <span class="heart">â™¥</span> {{ t.get('by', 'by') }} StuXan
      </footer>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
    <script>
      const initialFarmerStatus = "{{ farmer_status }}";
      document.getElementById('farmer-state').textContent = initialFarmerStatus;
      window.__INITIAL_GAME_ID = "{{ current_game_id }}";
      window.__INITIAL_MODE = "{{ current_drop_type }}";
    </script>
  </body>
</html>